{#
/**
 * @file
 * accordion
 *
 * Available variables for accordion:
 *  - accordion.data [array]: array of tab objects.
 *    - title [string]: Accordion title.
 *    - panel [string]: Panel content.
 *  - accordion.collapsed [bool]: Will start will all panels collapsed.
 *  - accordion.allow_toggle [bool]: Allow for each toggle to both open and close its section. Makes it possible for all sections to be closed. Assumes only one section may be open.
 *  - accordion.allow_multiple [bool]: Allow for multiple accordion sections to be expanded at the same time. Assumes data-allow-toggle otherwise the toggle on open sections would be disabled.
 */
#}
{% set seed = random() %}
{% set trigger_element = accordion.trigger_element|default('h3') %}
<div class="accordion mb-4 focus-within:shadow-outline"
  {{ accordion.allow_toggle or accordion.collapsed ? 'data-allow-toggle="true"' }}
  {{ accordion.allow_multiple ? 'data-allow-multiple="true"' }}
>
  {% for item in accordion.data %}
    {% set item_uid = "#{seed}-#{loop.index}" %}
    <{{ trigger_element }}>
      <button {{ loop.first and not accordion.collapsed ? 'aria-expanded="true"' }}
        class="accordion__trigger block w-full text-left px-4 py-2 border {{ loop.first ?: 'border-t-0' }} focus:outline-none focus:shadow-outline"
        aria-controls="accordion-panel--{{ item_uid }}"
        id="accordion-trigger--{{ item_uid }}">
        <span class="accordion__trigger-title flex justify-between items-center">
          {{ item.title }}
          <span class="accordion__trigger-icon inline-block w-4 h-4">
            {% include '@atoms/svg/_svg.twig' with {
              svg: {
                variant: 'sprite',
                name: 'chevron-down',
              }
            } %}
          </span>
        </span>
      </button>
    </{{ trigger_element }}>
    <div id="accordion-panel--{{ item_uid }}"
         role="region"
         aria-labelledby="accordion-trigger--{{ item_uid }}"
         class="accordion__panel p-4 border border-t-0"
         {{ loop.first and not accordion.collapsed ?: 'hidden' }}>
      {{ item.panel }}
    </div>
  {% endfor %}
</div>
